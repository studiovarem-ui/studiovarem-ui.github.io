<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>POKÉMON RANDOM GAME</title>

  <style>
    :root{
      /* ✅ WHITE THEME */
      --bg:#f5f6f8;
      --fg:#0f172a;
      --muted:rgba(15,23,42,.55);
      --card:#ffffff;
      --line:rgba(15,23,42,.10);
      --accent:#557CF3;
    }

    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh;
      display:flex; align-items:center; justify-content:center;
      background: var(--bg);
      color:var(--fg);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      overflow:hidden;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
    }
    body::before{
      content:"";
      position:fixed; inset:0;
      background:
        radial-gradient(900px 600px at 50% 35%, rgba(85,124,243,.10), transparent 60%),
        radial-gradient(700px 450px at 20% 70%, rgba(15,23,42,.05), transparent 55%);
      pointer-events:none;
      opacity:.9;
    }

    .frame{
      width:min(560px, 94vw);
      padding:22px 18px;
      border:1px solid var(--line);
      border-radius:18px;
      background: linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.90));
      box-shadow: 0 18px 50px rgba(15,23,42,.18);
      position:relative;
      overflow:hidden;
    }

    .brand{
      letter-spacing:.38em;
      font-weight:900;
      font-size:12px;
      opacity:.7;
    }

    .screen{
      display:none;
      min-height:520px;
      padding:18px 10px 10px;
      position:relative;
    }
    .screen.active{display:block}

    .title{
      margin:18px 0 6px;
      font-size:28px;
      line-height:1.1;
      letter-spacing:.08em;
      text-transform:uppercase;
      text-shadow: 0 0 18px rgba(85,124,243,.12);
    }
    .subtitle{
      margin:0 0 18px;
      font-size:12px;
      color:var(--muted);
      letter-spacing:.16em;
      text-transform:uppercase;
    }

    .center{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:14px;
      min-height:420px;
      text-align:center;
    }

    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:14px 22px;
      border-radius:14px;
      border:1px solid rgba(85,124,243,.55);
      background: rgba(85,124,243,.10);
      color:var(--fg);
      font-weight:900;
      letter-spacing:.18em;
      text-transform:uppercase;
      cursor:pointer;
      transition: transform .08s ease, box-shadow .12s ease;
    }
    .btn:active{
      transform: translateY(1px) scale(.99);
      box-shadow: 0 0 28px rgba(85,124,243,.22);
    }

    .blink{ animation: blink 1.1s steps(2,end) infinite; }
    @keyframes blink{ 50%{opacity:.25} }

    .foot{
      margin-top:10px;
      color:var(--muted);
      font-size:11px;
      letter-spacing:.08em;
      line-height:1.5;
    }

    .toast{
      position:absolute;
      top:14px;
      left:50%;
      transform: translateX(-50%);
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.75);
      backdrop-filter: blur(6px);
      font-size:11px;
      letter-spacing:.12em;
      text-transform:uppercase;
      opacity:0;
      transition: opacity .18s ease;
      pointer-events:none;
      box-shadow: 0 12px 30px rgba(15,23,42,.10);
    }
    .toast.on{ opacity:1; }

    /* Screen 2 balls */
    .ball-grid{
      width:100%;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:14px;
      padding:18px 8px;
      opacity:0;
      transform: translateY(6px);
      transition: opacity .25s ease, transform .25s ease;
    }
    .ball-grid.show{
      opacity:1;
      transform: translateY(0);
    }

    .ball{
      aspect-ratio: 1 / 1;
      border-radius:18px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.70);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      overflow:hidden;
      cursor:pointer;
      transition: transform .12s ease, border-color .12s ease, box-shadow .12s ease;
      box-shadow: 0 10px 20px rgba(15,23,42,.08);
    }
    .ball:active{
      transform: scale(.985);
      border-color: rgba(85,124,243,.55);
      box-shadow: 0 14px 26px rgba(15,23,42,.12);
    }
    .ball img{
      width:72%;
      height:auto;
      filter: drop-shadow(0 10px 14px rgba(15,23,42,.18));
      animation: float 1.2s ease-in-out infinite;
    }
    @keyframes float{
      0%,100%{ transform: translateY(0) }
      50%{ transform: translateY(-4px) }
    }

    .row{
      display:flex;
      gap:10px;
      justify-content:center;
      margin-top:12px;
      flex-wrap:wrap;
    }
    .mini{
      padding:10px 14px;
      border-radius:12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.70);
      color:var(--fg);
      font-weight:900;
      letter-spacing:.12em;
      text-transform:uppercase;
      cursor:pointer;
      box-shadow: 0 10px 20px rgba(15,23,42,.08);
    }
    .mini:active{ transform: translateY(1px); }

    /* Screen 3 throw area */
    .throw-area{
      width:100%;
      height:420px;
      border-radius:18px;
      border:1px dashed rgba(15,23,42,.18);
      background: rgba(255,255,255,.65);
      position:relative;
      overflow:hidden;
      display:flex;
      align-items:flex-end;
      justify-content:center;
      padding-bottom:26px;
      touch-action:none;
      box-shadow: inset 0 0 0 1px rgba(15,23,42,.03);
    }
    .throw-ball{
      width:120px;
      height:120px;
      border-radius:999px;
      display:flex;
      align-items:center;
      justify-content:center;
      position:absolute;
      bottom:26px;
      left:50%;
      transform: translateX(-50%);
      transition: transform .1s ease;
      will-change: transform;
    }
    .throw-ball img{
      width:100%;
      height:auto;
      filter: drop-shadow(0 14px 16px rgba(15,23,42,.20));
    }

    /* Screen 4 capture */
    .capture-stage{
      width:100%;
      height:420px;
      border-radius:18px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.65);
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      box-shadow: inset 0 0 0 1px rgba(15,23,42,.03);
    }
    .orbit{
      position:absolute;
      width:240px;
      height:240px;
      border-radius:999px;
      border:1px solid rgba(85,124,243,.20);
      animation: spin 1.1s linear infinite;
      opacity:.9;
    }
    @keyframes spin{ to{ transform: rotate(360deg) } }

    .cap-ball{
      width:140px;
      height:140px;
      display:flex;
      align-items:center;
      justify-content:center;
      animation: wobble .36s ease-in-out infinite;
      filter: drop-shadow(0 16px 18px rgba(15,23,42,.22));
    }
    @keyframes wobble{
      0%,100%{ transform: rotate(-6deg) }
      50%{ transform: rotate(6deg) }
    }
    .cap-ball img{ width:100%; height:auto; }

    .count{
      position:absolute;
      top:18px;
      right:18px;
      font-size:42px;
      font-weight:900;
      letter-spacing:.08em;
      text-shadow: 0 0 18px rgba(85,124,243,.14);
    }

    /* Screen 5 reveal */
    .reveal{
      width:100%;
      height:420px;
      border-radius:18px;
      border:1px solid var(--line);
      background: radial-gradient(220px 180px at 50% 40%, rgba(85,124,243,.16), transparent 70%),
                  rgba(255,255,255,.65);
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      box-shadow: inset 0 0 0 1px rgba(15,23,42,.03);
    }
    .flash{
      position:absolute; inset:-40%;
      background: radial-gradient(circle, rgba(255,255,255,.55), transparent 55%);
      opacity:0;
      transform: scale(.85);
      transition: opacity .18s ease, transform .18s ease;
    }
    .flash.on{
      opacity:1;
      transform: scale(1.05);
    }
    .poke{
      width:min(320px, 70vw);
      height:auto;
      filter: drop-shadow(0 18px 24px rgba(15,23,42,.22));
      transform: translateY(6px) scale(.98);
      opacity:0;
      transition: opacity .22s ease, transform .22s ease;
      background:transparent;
    }
    .poke.show{
      opacity:1;
      transform: translateY(0) scale(1);
    }

    .gotcha{
      position:absolute;
      bottom:16px;
      left:50%;
      transform: translateX(-50%);
      font-size:26px;
      font-weight:900;
      letter-spacing:.18em;
      text-transform:uppercase;
      color:#0f172a;
      text-shadow: 0 0 18px rgba(85,124,243,.12);
    }
  </style>
</head>

<body>
  <div class="frame">
    <div class="brand">VAREM</div>
    <div id="toast" class="toast">READY</div>

    <!-- Screen 1 -->
    <section id="s1" class="screen active">
      <div class="center">
        <div>
          <div class="title">POKÉMON<br/>RANDOM GAME</div>
          <div class="subtitle blink">press start</div>
        </div>
        <button id="startBtn" class="btn">START</button>
        <div class="foot">
          * 배경: 화이트 테마(가독성↑)<br/>
          * 이미지는 /pokemon/images 폴더에 넣기
        </div>
      </div>
    </section>

    <!-- Screen 2 -->
    <section id="s2" class="screen">
      <div class="center" style="gap:10px;">
        <div class="title" style="font-size:18px;margin:8px 0 0;">CHOOSE ONE!</div>
        <div class="subtitle" id="s2Sub">loading balls…</div>

        <div id="ballGrid" class="ball-grid" aria-label="Poké Balls"></div>

        <div class="row">
          <button id="back1" class="mini">BACK</button>
        </div>
      </div>
    </section>

    <!-- Screen 3 -->
    <section id="s3" class="screen">
      <div class="center" style="gap:10px;">
        <div class="title" style="font-size:18px;margin:8px 0 0;">SWIPE UP!</div>
        <div class="subtitle">throw the ball</div>

        <div id="throwArea" class="throw-area">
          <div id="throwBall" class="throw-ball">
            <img id="throwBallImg" alt="ball" src="images/Poke_ball.png" />
          </div>
        </div>

        <div class="row">
          <button id="restart" class="mini">RESTART</button>
        </div>
      </div>
    </section>

    <!-- Screen 4 -->
    <section id="s4" class="screen">
      <div class="center" style="gap:10px;">
        <div class="title" style="font-size:18px;margin:8px 0 0;">CATCHING…</div>
        <div class="subtitle">hold your breath</div>

        <div class="capture-stage">
          <div class="orbit"></div>
          <div class="orbit" style="width:320px;height:320px;opacity:.45;animation-duration:1.6s"></div>
          <div class="cap-ball">
            <img id="capBallImg" alt="ball" src="images/Poke_ball.png" />
          </div>
          <div id="count" class="count">3</div>
        </div>
      </div>
    </section>

    <!-- Screen 5 -->
    <section id="s5" class="screen">
      <div class="center" style="gap:10px;">
        <div class="title" style="font-size:18px;margin:8px 0 0;">RESULT</div>
        <div class="subtitle">random reveal</div>

        <div class="reveal">
          <div id="flash" class="flash"></div>
          <img id="pokeImg" class="poke" alt="pokemon" src="" />
          <div class="gotcha">GOTCHA!</div>
        </div>

        <div class="row">
          <button id="again" class="mini">AGAIN</button>
          <button id="home" class="mini">HOME</button>
        </div>
      </div>
    </section>
  </div>

  <script>
    /***********************
     * ✅ 너의 실제 파일명에 맞춘 버전
     * - 볼: images/Beast_ball.png ... (대소문자 그대로)
     * - 포켓몬: images/poke_01.png ~ images/poke_30.png
     ************************/

    // ✅ 포켓몬 01~30 자동 생성
    const pokemonList = [];
    for (let i = 1; i <= 30; i++) {
      pokemonList.push(`images/poke_${String(i).padStart(2, "0")}.png`);
    }

    const CONFIG = {
      balls: [
        "images/Beast_ball.png",
        "images/Fast_ball.png",
        "images/Net_ball.png",
        "images/Great_ball.png",
        "images/Master_ball.png",
        "images/Poke_ball.png",
        "images/Ultra_ball.png",
      ],
      pokemons: pokemonList,
      ballsAppearDelayMs: 2000,
      countdownMs: 900
    };

    const $ = (sel) => document.querySelector(sel);

    const screens = ["#s1", "#s2", "#s3", "#s4", "#s5"].map(s => $(s));
    const toast = $("#toast");

    const startBtn = $("#startBtn");
    const back1 = $("#back1");
    const restart = $("#restart");
    const again = $("#again");
    const home = $("#home");

    const ballGrid = $("#ballGrid");
    const s2Sub = $("#s2Sub");

    const throwArea = $("#throwArea");
    const throwBall = $("#throwBall");
    const throwBallImg = $("#throwBallImg");
    const capBallImg = $("#capBallImg");
    const countEl = $("#count");

    const flash = $("#flash");
    const pokeImg = $("#pokeImg");

    let chosenBallSrc = "images/Poke_ball.png";
    let chosenPokemonSrc = "";
    let ballShowTimer = null;
    let countdownTimer = null;
    let touch = { active:false, startY:0, startX:0, startT:0 };

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add("on");
      setTimeout(()=>toast.classList.remove("on"), 700);
    }

    function go(n){
      screens.forEach((el,i)=> el.classList.toggle("active", i===n));
    }

    function resetRun(){
      chosenBallSrc = "images/Poke_ball.png";
      chosenPokemonSrc = "";
      throwBallImg.src = chosenBallSrc;
      capBallImg.src = chosenBallSrc;

      ballGrid.classList.remove("show");
      ballGrid.innerHTML = "";
      s2Sub.textContent = "loading balls…";

      flash.classList.remove("on");
      pokeImg.classList.remove("show");
      pokeImg.src = "";
    }

    function pickRandom(arr){
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function buildBallGrid(){
      ballGrid.innerHTML = "";
      const list = (CONFIG.balls && CONFIG.balls.length) ? CONFIG.balls : ["images/Poke_ball.png"];

      list.forEach((src, idx) => {
        const b = document.createElement("div");
        b.className = "ball";
        b.setAttribute("role","button");
        b.setAttribute("aria-label", "ball "+(idx+1));
        b.innerHTML = `<img alt="ball" src="${src}">`;
        b.addEventListener("click", () => onChooseBall(src));
        ballGrid.appendChild(b);
      });
    }

    function enterScreen2(){
      go(1);
      resetRun();
      buildBallGrid();

      clearTimeout(ballShowTimer);
      ballShowTimer = setTimeout(() => {
        s2Sub.textContent = "tap the first ball!";
        ballGrid.classList.add("show");
        showToast("CHOOSE ONE!");
      }, CONFIG.ballsAppearDelayMs);
    }

    function onChooseBall(src){
      if (!ballGrid.classList.contains("show")) return;

      chosenBallSrc = src;
      throwBallImg.src = chosenBallSrc;
      capBallImg.src = chosenBallSrc;

      showToast("SELECTED!");
      go(2);
    }

    // swipe
    function onTouchStart(e){
      if (e.touches && e.touches.length){
        touch.active = true;
        touch.startY = e.touches[0].clientY;
        touch.startX = e.touches[0].clientX;
        touch.startT = performance.now();
      }
    }
    function onTouchMove(e){
      if (!touch.active) return;
      const y = e.touches[0].clientY;
      const dy = Math.min(0, y - touch.startY);
      throwBall.style.transform = `translateX(-50%) translateY(${dy * 0.35}px)`;
      e.preventDefault();
    }
    function onTouchEnd(e){
      if (!touch.active) return;
      touch.active = false;

      const endT = performance.now();
      const dt = Math.max(1, endT - touch.startT);

      const ct = (e.changedTouches && e.changedTouches[0]) ? e.changedTouches[0] : null;
      const endY = ct ? ct.clientY : touch.startY;
      const dyTotal = endY - touch.startY;

      throwBall.style.transform = `translateX(-50%)`;

      if (dyTotal < -70){
        const speed = Math.min(1.6, Math.max(0.6, (-dyTotal) / dt * 2.2));
        animateThrow(speed);
      } else {
        showToast("SWIPE UP!");
      }
    }

    function animateThrow(speed){
      throwBall.style.transition = "transform .38s ease";
      const up = -380 * speed;
      const scale = 0.42;
      throwBall.style.transform = `translateX(-50%) translateY(${up}px) scale(${scale}) rotate(${220*speed}deg)`;

      showToast("THROW!");
      setTimeout(() => {
        throwBall.style.transition = "transform .1s ease";
        throwBall.style.transform = `translateX(-50%)`;
        enterScreen4();
      }, 420);
    }

    function enterScreen4(){
      go(3);
      countEl.textContent = "3";
      clearInterval(countdownTimer);

      let n = 3;
      countdownTimer = setInterval(() => {
        n--;
        countEl.textContent = String(n);
        if (n <= 0){
          clearInterval(countdownTimer);
          enterScreen5();
        }
      }, CONFIG.countdownMs);
    }

    function enterScreen5(){
      go(4);
      chosenPokemonSrc = pickRandom(CONFIG.pokemons);

      flash.classList.add("on");
      setTimeout(() => flash.classList.remove("on"), 220);

      pokeImg.src = chosenPokemonSrc;
      pokeImg.onerror = () => {
        pokeImg.alt = "이미지 파일을 찾을 수 없어요: " + chosenPokemonSrc;
        showToast("IMG NOT FOUND");
      };

      setTimeout(() => {
        pokeImg.classList.add("show");
        showToast("GOTCHA!");
      }, 120);
    }

    // buttons
    startBtn.addEventListener("click", () => { showToast("START!"); enterScreen2(); });
    back1.addEventListener("click", () => { clearTimeout(ballShowTimer); go(0); });
    restart.addEventListener("click", () => { showToast("RESTART"); enterScreen2(); });
    again.addEventListener("click", () => { showToast("AGAIN"); enterScreen2(); });
    home.addEventListener("click", () => { showToast("HOME"); go(0); });

    // swipe listeners
    throwArea.addEventListener("touchstart", onTouchStart, {passive:false});
    throwArea.addEventListener("touchmove", onTouchMove, {passive:false});
    throwArea.addEventListener("touchend", onTouchEnd, {passive:true});

    // desktop test
    let mouseDown = false;
    throwArea.addEventListener("mousedown", (e)=>{
      mouseDown = true;
      touch.active = true;
      touch.startY = e.clientY;
      touch.startX = e.clientX;
      touch.startT = performance.now();
    });
    window.addEventListener("mousemove", (e)=>{
      if (!mouseDown || !touch.active) return;
      const dy = Math.min(0, e.clientY - touch.startY);
      throwBall.style.transform = `translateX(-50%) translateY(${dy * 0.35}px)`;
    });
    window.addEventListener("mouseup", (e)=>{
      if (!mouseDown) return;
      mouseDown = false;
      const endT = performance.now();
      const dt = Math.max(1, endT - touch.startT);
      const dyTotal = e.clientY - touch.startY;
      throwBall.style.transform = `translateX(-50%)`;
      if (dyTotal < -70){
        const speed = Math.min(1.6, Math.max(0.6, (-dyTotal) / dt * 2.2));
        animateThrow(speed);
      } else {
        showToast("SWIPE UP!");
      }
      touch.active = false;
    });

    showToast("READY");
  </script>
</body>
</html>

