<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>POKÉMON RANDOM GAME</title>
  <style>
    :root{
      --bg:#0b0f1a;
      --fg:#eaf0ff;
      --muted:rgba(234,240,255,.65);
      --card:rgba(255,255,255,.06);
      --line:rgba(255,255,255,.14);
      --accent:#57a6ff;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh;
      display:flex; align-items:center; justify-content:center;
      background: radial-gradient(900px 600px at 50% 35%, rgba(87,166,255,.14), transparent 60%),
                  radial-gradient(700px 450px at 20% 70%, rgba(255,255,255,.06), transparent 55%),
                  var(--bg);
      color:var(--fg);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      overflow:hidden;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
    }

    /* subtle CRT scanlines */
    body::before{
      content:"";
      position:fixed; inset:0;
      background: repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,.035),
        rgba(255,255,255,.035) 1px,
        rgba(0,0,0,0) 2px,
        rgba(0,0,0,0) 4px
      );
      pointer-events:none;
      mix-blend-mode: overlay;
      opacity:.35;
    }

    .frame{
      width:min(560px, 94vw);
      padding:22px 18px;
      border:1px solid var(--line);
      border-radius:18px;
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      box-shadow: 0 18px 50px rgba(0,0,0,.5);
      position:relative;
      overflow:hidden;
    }

    .brand{
      letter-spacing:.38em;
      font-weight:700;
      font-size:12px;
      opacity:.7;
    }

    .screen{
      display:none;
      min-height:520px;
      padding:18px 10px 10px;
      position:relative;
    }
    .screen.active{display:block}

    .title{
      margin:18px 0 6px;
      font-size:28px;
      line-height:1.1;
      letter-spacing:.08em;
      text-transform:uppercase;
      text-shadow: 0 0 14px rgba(87,166,255,.22);
    }
    .subtitle{
      margin:0 0 18px;
      font-size:12px;
      color:var(--muted);
      letter-spacing:.16em;
      text-transform:uppercase;
    }

    .center{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:14px;
      min-height:420px;
      text-align:center;
    }

    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:14px 22px;
      border-radius:14px;
      border:1px solid rgba(87,166,255,.55);
      background: rgba(87,166,255,.10);
      color:var(--fg);
      font-weight:800;
      letter-spacing:.18em;
      text-transform:uppercase;
      cursor:pointer;
      box-shadow: 0 0 0 rgba(87,166,255,0);
      transition: transform .08s ease, box-shadow .12s ease;
    }
    .btn:active{
      transform: translateY(1px) scale(.99);
      box-shadow: 0 0 28px rgba(87,166,255,.25);
    }

    .blink{
      animation: blink 1.1s steps(2,end) infinite;
    }
    @keyframes blink{ 50%{opacity:.25} }

    .hint{
      font-size:12px;
      color:var(--muted);
      letter-spacing:.12em;
      text-transform:uppercase;
    }

    /* Screen 2 balls */
    .ball-grid{
      width:100%;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:14px;
      padding:18px 8px;
      opacity:0;
      transform: translateY(6px);
      transition: opacity .25s ease, transform .25s ease;
    }
    .ball-grid.show{
      opacity:1;
      transform: translateY(0);
    }

    .ball{
      aspect-ratio: 1 / 1;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      overflow:hidden;
      cursor:pointer;
      transition: transform .12s ease, border-color .12s ease;
    }
    .ball:active{ transform: scale(.98); border-color: rgba(87,166,255,.5); }
    .ball img{
      width:72%;
      height:auto;
      filter: drop-shadow(0 10px 14px rgba(0,0,0,.35));
      animation: float 1.2s ease-in-out infinite;
    }
    @keyframes float{
      0%,100%{ transform: translateY(0) }
      50%{ transform: translateY(-4px) }
    }

    /* Screen 3 throw area */
    .throw-area{
      width:100%;
      height:420px;
      border-radius:18px;
      border:1px dashed rgba(255,255,255,.18);
      background: rgba(255,255,255,.02);
      position:relative;
      overflow:hidden;
      display:flex;
      align-items:flex-end;
      justify-content:center;
      padding-bottom:26px;
      touch-action:none; /* for swipe */
    }
    .throw-ball{
      width:120px;
      height:120px;
      border-radius:999px;
      display:flex;
      align-items:center;
      justify-content:center;
      position:absolute;
      bottom:26px;
      left:50%;
      transform: translateX(-50%);
      transition: transform .1s ease;
      will-change: transform;
    }
    .throw-ball img{
      width:100%;
      height:auto;
      filter: drop-shadow(0 12px 16px rgba(0,0,0,.45));
    }

    /* Screen 4 capture */
    .capture-stage{
      width:100%;
      height:420px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.02);
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }
    .orbit{
      position:absolute;
      width:240px;
      height:240px;
      border-radius:999px;
      border:1px solid rgba(87,166,255,.18);
      animation: spin 1.1s linear infinite;
      opacity:.8;
    }
    @keyframes spin{ to{ transform: rotate(360deg) } }

    .cap-ball{
      width:140px;
      height:140px;
      display:flex;
      align-items:center;
      justify-content:center;
      animation: wobble .36s ease-in-out infinite;
      filter: drop-shadow(0 16px 18px rgba(0,0,0,.45));
    }
    @keyframes wobble{
      0%,100%{ transform: rotate(-6deg) }
      50%{ transform: rotate(6deg) }
    }
    .cap-ball img{ width:100%; height:auto; }

    .count{
      position:absolute;
      top:18px;
      right:18px;
      font-size:42px;
      font-weight:900;
      letter-spacing:.08em;
      text-shadow: 0 0 22px rgba(87,166,255,.20);
    }

    /* Screen 5 reveal */
    .reveal{
      width:100%;
      height:420px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background: radial-gradient(220px 180px at 50% 40%, rgba(87,166,255,.18), transparent 70%),
                  rgba(255,255,255,.02);
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }
    .flash{
      position:absolute; inset:-40%;
      background: radial-gradient(circle, rgba(255,255,255,.18), transparent 55%);
      opacity:0;
      transform: scale(.85);
      transition: opacity .18s ease, transform .18s ease;
    }
    .flash.on{
      opacity:1;
      transform: scale(1.05);
    }
    .poke{
      width:min(320px, 70vw);
      height:auto;
      image-rendering: auto;
      filter: drop-shadow(0 18px 24px rgba(0,0,0,.55));
      transform: translateY(6px) scale(.98);
      opacity:0;
      transition: opacity .22s ease, transform .22s ease;
    }
    .poke.show{
      opacity:1;
      transform: translateY(0) scale(1);
    }

    .gotcha{
      position:absolute;
      bottom:16px;
      left:50%;
      transform: translateX(-50%);
      font-size:26px;
      font-weight:900;
      letter-spacing:.18em;
      text-transform:uppercase;
      text-shadow: 0 0 18px rgba(87,166,255,.22);
    }

    .row{
      display:flex;
      gap:10px;
      justify-content:center;
      margin-top:12px;
      flex-wrap:wrap;
    }
    .mini{
      padding:10px 14px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      color:var(--fg);
      font-weight:800;
      letter-spacing:.12em;
      text-transform:uppercase;
      cursor:pointer;
    }
    .mini:active{ transform: translateY(1px); }

    .foot{
      margin-top:10px;
      color:var(--muted);
      font-size:11px;
      letter-spacing:.08em;
      line-height:1.5;
    }

    /* small toast */
    .toast{
      position:absolute;
      top:14px;
      left:50%;
      transform: translateX(-50%);
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.35);
      backdrop-filter: blur(6px);
      font-size:11px;
      letter-spacing:.12em;
      text-transform:uppercase;
      opacity:0;
      transition: opacity .18s ease;
      pointer-events:none;
    }
    .toast.on{ opacity:1; }
  </style>
</head>

<body>
  <div class="frame">
    <div class="brand">VAREM</div>
    <div id="toast" class="toast">READY</div>

    <!-- Screen 1 -->
    <section id="s1" class="screen active">
      <div class="center">
        <div>
          <div class="title">POKÉMON<br/>RANDOM GAME</div>
          <div class="subtitle blink">press start</div>
        </div>
        <button id="startBtn" class="btn">START</button>
        <div class="foot">
          * 레트로 느낌 + 랜덤 뽑기<br/>
          * 이미지는 /images 폴더에 넣어두면 됨
        </div>
      </div>
    </section>

    <!-- Screen 2 -->
    <section id="s2" class="screen">
      <div class="center" style="gap:10px;">
        <div class="title" style="font-size:18px;margin:8px 0 0;">CHOOSE ONE!</div>
        <div class="subtitle" id="s2Sub">loading balls…</div>

        <div id="ballGrid" class="ball-grid" aria-label="Poké Balls">
          <!-- balls injected -->
        </div>

        <div class="row">
          <button id="back1" class="mini">BACK</button>
        </div>
      </div>
    </section>

    <!-- Screen 3 -->
    <section id="s3" class="screen">
      <div class="center" style="gap:10px;">
        <div class="title" style="font-size:18px;margin:8px 0 0;">SWIPE UP!</div>
        <div class="subtitle">throw the ball</div>

        <div id="throwArea" class="throw-area">
          <div id="throwBall" class="throw-ball">
            <img id="throwBallImg" alt="ball" src="images/ball.png" />
          </div>
        </div>

        <div class="row">
          <button id="restart" class="mini">RESTART</button>
        </div>
      </div>
    </section>

    <!-- Screen 4 -->
    <section id="s4" class="screen">
      <div class="center" style="gap:10px;">
        <div class="title" style="font-size:18px;margin:8px 0 0;">CATCHING…</div>
        <div class="subtitle">hold your breath</div>

        <div class="capture-stage">
          <div class="orbit"></div>
          <div class="orbit" style="width:320px;height:320px;opacity:.45;animation-duration:1.6s"></div>
          <div class="cap-ball">
            <img id="capBallImg" alt="ball" src="images/ball.png" />
          </div>
          <div id="count" class="count">3</div>
        </div>
      </div>
    </section>

    <!-- Screen 5 -->
    <section id="s5" class="screen">
      <div class="center" style="gap:10px;">
        <div class="title" style="font-size:18px;margin:8px 0 0;">RESULT</div>
        <div class="subtitle">random reveal</div>

        <div class="reveal">
          <div id="flash" class="flash"></div>
          <img id="pokeImg" class="poke" alt="pokemon" src="" />
          <div class="gotcha">GOTCHA!</div>
        </div>

        <div class="row">
          <button id="again" class="mini">AGAIN</button>
          <button id="home" class="mini">HOME</button>
        </div>
      </div>
    </section>
  </div>

  <script>
    /***********************
     * 1) 이미지 파일만 맞추면 바로 동작
     * - 공(볼): images/ball.png (필수)
     * - 포켓몬(캐릭터): images/poke_01.png ... 처럼 넣기
     ************************/

    // ✅ 여기만 너 파일명에 맞게 수정하면 됨
    const CONFIG = {
      // 2번 화면에 보여줄 볼 이미지들 (없으면 ball.png 하나로도 OK)
      balls: [
        "images/ball.png",
        "images/ball.png",
        "images/ball.png",
        "images/ball.png",
        "images/ball.png",
        "images/ball.png",
        "images/ball.png",
        "images/ball.png",
        "images/ball.png",
      ],
      // 결과로 나올 포켓몬 이미지들(이름 없이)
      pokemons: [
        "images/poke_01.png",
        "images/poke_02.png",
        "images/poke_03.png",
        "images/poke_04.png",
        "images/poke_05.png",
        "images/poke_06.png",
        "images/poke_07.png",
        "images/poke_08.png",
        "images/poke_09.png",
        "images/poke_10.png",
      ],
      // 2번 화면에서 볼이 등장하기까지 딜레이(너가 말한 2초)
      ballsAppearDelayMs: 2000,
      // 4번 카운트다운 속도
      countdownMs: 900
    };

    const $ = (sel) => document.querySelector(sel);

    const screens = ["#s1", "#s2", "#s3", "#s4", "#s5"].map(s => $(s));
    const toast = $("#toast");

    const startBtn = $("#startBtn");
    const back1 = $("#back1");
    const restart = $("#restart");
    const again = $("#again");
    const home = $("#home");

    const ballGrid = $("#ballGrid");
    const s2Sub = $("#s2Sub");

    const throwArea = $("#throwArea");
    const throwBall = $("#throwBall");
    const throwBallImg = $("#throwBallImg");
    const capBallImg = $("#capBallImg");
    const countEl = $("#count");

    const flash = $("#flash");
    const pokeImg = $("#pokeImg");

    let chosenBallSrc = "images/ball.png";
    let chosenPokemonSrc = "";
    let ballShowTimer = null;
    let countdownTimer = null;
    let touch = { active:false, startY:0, startX:0, startT:0 };

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add("on");
      setTimeout(()=>toast.classList.remove("on"), 700);
    }

    function go(n){
      screens.forEach((el,i)=> el.classList.toggle("active", i===n));
    }

    function resetRun(){
      chosenBallSrc = "images/ball.png";
      chosenPokemonSrc = "";
      throwBallImg.src = chosenBallSrc;
      capBallImg.src = chosenBallSrc;

      // screen2
      ballGrid.classList.remove("show");
      ballGrid.innerHTML = "";
      s2Sub.textContent = "loading balls…";

      // screen5
      flash.classList.remove("on");
      pokeImg.classList.remove("show");
      pokeImg.src = "";
    }

    function pickRandom(arr){
      return arr[Math.floor(Math.random() * arr.length)];
    }

    // --- Screen2: create balls after 2s
    function buildBallGrid(){
      ballGrid.innerHTML = "";
      const list = CONFIG.balls.length ? CONFIG.balls : ["images/ball.png"];

      list.forEach((src, idx) => {
        const b = document.createElement("div");
        b.className = "ball";
        b.setAttribute("role","button");
        b.setAttribute("aria-label", "ball "+(idx+1));
        b.innerHTML = `<img alt="ball" src="${src}">`;
        b.addEventListener("click", () => onChooseBall(src));
        ballGrid.appendChild(b);
      });
    }

    function enterScreen2(){
      go(1);
      resetRun();
      buildBallGrid();

      // 2초 후 볼 보여주기
      clearTimeout(ballShowTimer);
      ballShowTimer = setTimeout(() => {
        s2Sub.textContent = "tap the first ball!";
        ballGrid.classList.add("show");
        showToast("CHOOSE ONE!");
      }, CONFIG.ballsAppearDelayMs);
    }

    function onChooseBall(src){
      // 아직 등장 전이면 무시
      if (!ballGrid.classList.contains("show")) return;

      chosenBallSrc = src;
      throwBallImg.src = chosenBallSrc;
      capBallImg.src = chosenBallSrc;

      showToast("SELECTED!");
      go(2); // Screen3
    }

    // --- Screen3: swipe up to throw
    function onTouchStart(e){
      if (e.touches && e.touches.length){
        touch.active = true;
        touch.startY = e.touches[0].clientY;
        touch.startX = e.touches[0].clientX;
        touch.startT = performance.now();
      }
    }
    function onTouchMove(e){
      if (!touch.active) return;
      const y = e.touches[0].clientY;
      const dy = Math.min(0, y - touch.startY); // negative when moving up
      // 조금 따라 움직이는 느낌
      throwBall.style.transform = `translateX(-50%) translateY(${dy * 0.35}px)`;
      e.preventDefault();
    }
    function onTouchEnd(e){
      if (!touch.active) return;
      touch.active = false;

      const endT = performance.now();
      const dt = Math.max(1, endT - touch.startT);

      // 마지막 이동량 계산 (touchend에는 touches가 없을 수 있어 변화량은 마지막 move에서 대신)
      // 간단히: startY 대비 마지막 transform 값을 기반으로 판단하기보다,
      // 사용자 체감용으로 "충분히 위로 스와이프" 여부만 체크
      // => 터치 종료 시점의 changedTouches 사용
      const ct = (e.changedTouches && e.changedTouches[0]) ? e.changedTouches[0] : null;
      const endY = ct ? ct.clientY : touch.startY;
      const dyTotal = endY - touch.startY; // up = negative

      // reset visual
      throwBall.style.transform = `translateX(-50%)`;

      // 스와이프 판정: 위로 70px 이상
      if (dyTotal < -70){
        // 던지기 애니메이션 (강하게 스와이프할수록 더 멀리)
        const speed = Math.min(1.6, Math.max(0.6, (-dyTotal) / dt * 2.2));
        animateThrow(speed);
      } else {
        showToast("SWIPE UP!");
      }
    }

    function animateThrow(speed){
      // 위로 날아가며 작아지는 간단 연출
      throwBall.style.transition = "transform .38s ease";
      const up = -380 * speed;
      const scale = 0.42;
      throwBall.style.transform = `translateX(-50%) translateY(${up}px) scale(${scale}) rotate(${220*speed}deg)`;

      showToast("THROW!");
      // 연출 끝나면 Screen4
      setTimeout(() => {
        throwBall.style.transition = "transform .1s ease";
        throwBall.style.transform = `translateX(-50%)`;
        enterScreen4();
      }, 420);
    }

    // --- Screen4: 3,2,1 countdown then reveal
    function enterScreen4(){
      go(3);
      countEl.textContent = "3";
      clearInterval(countdownTimer);

      let n = 3;
      countdownTimer = setInterval(() => {
        n--;
        countEl.textContent = String(n);
        if (n <= 1){
          // 3,2,1 찍고 바로 결과로
          if (n === 1) showToast("…");
        }
        if (n <= 0){
          clearInterval(countdownTimer);
          enterScreen5();
        }
      }, CONFIG.countdownMs);
    }

    function enterScreen5(){
      go(4);

      // 랜덤 포켓몬 결정
      chosenPokemonSrc = pickRandom(CONFIG.pokemons);

      // flash + show
      flash.classList.add("on");
      setTimeout(() => flash.classList.remove("on"), 220);

      pokeImg.src = chosenPokemonSrc;
      // 이미지 로딩 실패 대비
      pokeImg.onerror = () => {
        pokeImg.alt = "이미지 파일을 찾을 수 없어요: " + chosenPokemonSrc;
        showToast("IMG NOT FOUND");
      };

      setTimeout(() => {
        pokeImg.classList.add("show");
        showToast("GOTCHA!");
      }, 120);
    }

    // --- buttons
    startBtn.addEventListener("click", () => {
      showToast("START!");
      enterScreen2();
    });

    back1.addEventListener("click", () => {
      clearTimeout(ballShowTimer);
      go(0);
    });

    restart.addEventListener("click", () => {
      showToast("RESTART");
      enterScreen2();
    });

    again.addEventListener("click", () => {
      showToast("AGAIN");
      enterScreen2();
    });

    home.addEventListener("click", () => {
      showToast("HOME");
      go(0);
    });

    // swipe listeners (Screen3)
    throwArea.addEventListener("touchstart", onTouchStart, {passive:false});
    throwArea.addEventListener("touchmove", onTouchMove, {passive:false});
    throwArea.addEventListener("touchend", onTouchEnd, {passive:true});

    // desktop test (mouse drag)
    let mouseDown = false;
    throwArea.addEventListener("mousedown", (e)=>{
      mouseDown = true;
      touch.active = true;
      touch.startY = e.clientY;
      touch.startX = e.clientX;
      touch.startT = performance.now();
    });
    window.addEventListener("mousemove", (e)=>{
      if (!mouseDown || !touch.active) return;
      const dy = Math.min(0, e.clientY - touch.startY);
      throwBall.style.transform = `translateX(-50%) translateY(${dy * 0.35}px)`;
    });
    window.addEventListener("mouseup", (e)=>{
      if (!mouseDown) return;
      mouseDown = false;
      const endT = performance.now();
      const dt = Math.max(1, endT - touch.startT);
      const dyTotal = e.clientY - touch.startY;
      throwBall.style.transform = `translateX(-50%)`;
      if (dyTotal < -70){
        const speed = Math.min(1.6, Math.max(0.6, (-dyTotal) / dt * 2.2));
        animateThrow(speed);
      } else {
        showToast("SWIPE UP!");
      }
      touch.active = false;
    });

    // initial
    showToast("READY");
  </script>
</body>
</html>