<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>POKÉMON RANDOM GAME</title>

  <style>
    :root{
      --bg:#ffffff;             /* ✅ 완전 흰 배경 */
      --fg:#0f172a;
      --muted:rgba(15,23,42,.55);
      --line:rgba(15,23,42,.10);
      --accent:#557CF3;
    }

    *{ box-sizing:border-box; }
    html, body { height:100%; }

    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background: var(--bg);
      color:var(--fg);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
      overflow:hidden;
    }

    /* ✅ 메인 카드(프레임)만 살리고 내부 박스는 투명 */
    .frame{
      width:min(560px, 94vw);
      padding:22px 18px;
      border:1px solid var(--line);
      border-radius:18px;
      background:#fff;
      box-shadow: 0 18px 40px rgba(0,0,0,0.12);
      position:relative;
      overflow:hidden;
    }

    .brand{
      letter-spacing:.38em;
      font-weight:900;
      font-size:12px;
      opacity:.7;
    }

    .screen{
      display:none;
      min-height:520px;
      padding:18px 10px 10px;
      position:relative;
    }
    .screen.active{ display:block; }

    .title{
      margin:18px 0 6px;
      font-size:28px;
      line-height:1.1;
      letter-spacing:.08em;
      text-transform:uppercase;
      text-shadow: 0 0 18px rgba(85,124,243,.10);
    }
    .subtitle{
      margin:0 0 18px;
      font-size:12px;
      color:var(--muted);
      letter-spacing:.16em;
      text-transform:uppercase;
    }

    .center{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:14px;
      min-height:420px;
      text-align:center;
    }

    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:14px 22px;
      border-radius:14px;
      border:1px solid rgba(85,124,243,.55);
      background: rgba(85,124,243,.10);
      color:var(--fg);
      font-weight:900;
      letter-spacing:.18em;
      text-transform:uppercase;
      cursor:pointer;
      transition: transform .08s ease, box-shadow .12s ease;
    }
    .btn:active{
      transform: translateY(1px) scale(.99);
      box-shadow: 0 0 28px rgba(85,124,243,.18);
    }

    /* ✅ 요구사항: 설명/부제 텍스트 전부 제거 */
    .subtitle,
    .foot,
    .roulette-title,
    .tap-anywhere {
      display:none !important;
    }

    /* toast(상단 알림)도 필요 없으면 아래 주석 해제 */
    .toast{
      position:absolute;
      top:14px;
      left:50%;
      transform: translateX(-50%);
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.92);
      font-size:11px;
      letter-spacing:.12em;
      text-transform:uppercase;
      opacity:0;
      transition: opacity .18s ease;
      pointer-events:none;
      box-shadow: 0 12px 30px rgba(15,23,42,.10);
    }
    .toast.on{ opacity:1; }
    /* .toast{ display:none !important; } */

    /* ✅ 내부 박스(씬 박스)는 투명/무테/무그림자 */
    .roulette-wrap,
    .throw-area,
    .capture-stage,
    .reveal{
      width:100%;
      height:420px;
      border-radius:18px;
      background:transparent;
      border:none;
      box-shadow:none;
      position:relative;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* ✅ 이미지 리사이징 임의로 하지 않기:
       - width/height는 auto
       - 화면 밖으로 나가지만 않게 max만 걸기 */
    img{
      width:auto;
      height:auto;
      max-width:100%;
      max-height:100%;
      user-select:none;
      -webkit-user-drag:none;
    }

    /* (선택) 네가 맞춘 픽셀을 최대한 유지: 최대 크기만 제한 */
    .roulette-ball img,
    .throw-ball img,
    .cap-ball img,
    #pokeImg{
      max-width: 320px;
      max-height: 320px;
    }

    /* Screen 2: roulette */
    .roulette-wrap{
      flex-direction:column;
      gap:12px;
      touch-action: manipulation;
    }
    .roulette-ball{
      width:auto;
      height:auto;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      filter: drop-shadow(0 14px 18px rgba(15,23,42,.10));
    }
    .roulette-ring{
      position:absolute;
      width:320px;
      height:320px;
      border-radius:999px;
      border:1px solid rgba(85,124,243,.20);
      animation: spin 1.1s linear infinite;
      opacity:.9;
      pointer-events:none;
    }
    @keyframes spin{ to{ transform: rotate(360deg) } }

    .row{
      display:flex;
      gap:10px;
      justify-content:center;
      margin-top:12px;
      flex-wrap:wrap;
    }
    .mini{
      padding:10px 14px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#fff;
      color:var(--fg);
      font-weight:900;
      letter-spacing:.12em;
      text-transform:uppercase;
      cursor:pointer;
      box-shadow: 0 10px 20px rgba(15,23,42,.08);
    }
    .mini:active{ transform: translateY(1px); }

    /* Screen 3: swipe throw */
    .throw-area{
      align-items:flex-end;
      justify-content:center;
      padding-bottom:26px;
      touch-action:none;
    }
    .throw-ball{
      position:absolute;
      bottom:26px;
      left:50%;
      transform: translateX(-50%);
      transition: transform .1s ease;
      will-change: transform;
      filter: drop-shadow(0 14px 16px rgba(15,23,42,.12));
    }

    /* Screen 4: capture */
    .orbit{
      position:absolute;
      width:320px;
      height:320px;
      border-radius:999px;
      border:1px solid rgba(85,124,243,.18);
      animation: spin 1.1s linear infinite;
      opacity:.9;
      pointer-events:none;
    }
    .orbit.big{
      width:420px;
      height:420px;
      opacity:.35;
      animation-duration:1.6s;
    }
    .cap-ball{
      filter: drop-shadow(0 16px 18px rgba(15,23,42,.12));
      animation: wobble .36s ease-in-out infinite;
    }
    @keyframes wobble{
      0%,100%{ transform: rotate(-6deg) }
      50%{ transform: rotate(6deg) }
    }
    .count{
      position:absolute;
      top:18px;
      right:18px;
      font-size:42px;
      font-weight:900;
      letter-spacing:.08em;
      text-shadow: 0 0 18px rgba(85,124,243,.10);
    }

    /* Screen 5: reveal */
    .flash{
      position:absolute;
      inset:-40%;
      background: radial-gradient(circle, rgba(85,124,243,.18), transparent 55%);
      opacity:0;
      transform: scale(.85);
      transition: opacity .18s ease, transform .18s ease;
      pointer-events:none;
    }
    .flash.on{
      opacity:1;
      transform: scale(1.05);
    }
    #pokeImg{
      filter: drop-shadow(0 18px 24px rgba(15,23,42,.12));
      transform: translateY(6px) scale(.98);
      opacity:0;
      transition: opacity .22s ease, transform .22s ease;
    }
    #pokeImg.show{
      opacity:1;
      transform: translateY(0) scale(1);
    }

    .gotcha{
      position:absolute;
      bottom:16px;
      left:50%;
      transform: translateX(-50%);
      font-size:26px;
      font-weight:900;
      letter-spacing:.18em;
      text-transform:uppercase;
      color:#0f172a;
      text-shadow: 0 0 18px rgba(85,124,243,.08);
      pointer-events:none;
    }
  </style>
</head>

<body>
  <div class="frame">
    <div class="brand">VAREM</div>
    <div id="toast" class="toast">READY</div>

    <!-- Screen 1 -->
    <section id="s1" class="screen active">
      <div class="center">
        <div class="title">POKÉMON<br/>RANDOM GAME</div>
        <button id="startBtn" class="btn">START</button>
        <!-- ✅ 설명 문구 삭제 완료 -->
      </div>
    </section>

    <!-- Screen 2 (Roulette) -->
    <section id="s2" class="screen">
      <div class="center" style="gap:10px;">
        <div class="title" style="font-size:18px;margin:8px 0 0;">CHOOSE ONE!</div>
        <div class="subtitle" id="s2Sub">starting roulette…</div>

        <div id="rouletteWrap" class="roulette-wrap" aria-label="Ball Roulette">
          <div class="roulette-title">balls are spinning…</div>

          <div class="roulette-ball" id="rouletteBall">
            <div class="roulette-ring"></div>
            <img id="rouletteImg" alt="ball" src="images/Poke_ball.png" />
          </div>

          <div class="tap-anywhere">tap anywhere to stop</div>
        </div>

        <div class="row">
          <button id="back1" class="mini">BACK</button>
        </div>
      </div>
    </section>

    <!-- Screen 3 -->
    <section id="s3" class="screen">
      <div class="center" style="gap:10px;">
        <div class="title" style="font-size:18px;margin:8px 0 0;">SWIPE UP!</div>
        <div class="subtitle">throw the ball</div>

        <div id="throwArea" class="throw-area">
          <div id="throwBall" class="throw-ball">
            <img id="throwBallImg" alt="ball" src="images/Poke_ball.png" />
          </div>
        </div>

        <div class="row">
          <button id="restart" class="mini">RESTART</button>
        </div>
      </div>
    </section>

    <!-- Screen 4 -->
    <section id="s4" class="screen">
      <div class="center" style="gap:10px;">
        <div class="title" style="font-size:18px;margin:8px 0 0;">CATCHING…</div>
        <div class="subtitle">3, 2, 1</div>

        <div class="capture-stage">
          <div class="orbit big"></div>
          <div class="orbit"></div>
          <div class="cap-ball">
            <img id="capBallImg" alt="ball" src="images/Poke_ball.png" />
          </div>
          <div id="count" class="count">3</div>
        </div>
      </div>
    </section>

    <!-- Screen 5 -->
    <section id="s5" class="screen">
      <div class="center" style="gap:10px;">
        <div class="title" style="font-size:18px;margin:8px 0 0;">RESULT</div>
        <div class="subtitle">random reveal</div>

        <div class="reveal">
          <div id="flash" class="flash"></div>
          <img id="pokeImg" alt="pokemon" src="" />
          <div class="gotcha">GOTCHA!</div>
        </div>

        <div class="row">
          <button id="again" class="mini">AGAIN</button>
          <button id="home" class="mini">HOME</button>
        </div>
      </div>
    </section>
  </div>

  <script>
    /***********************
     * ✅ 네 파일명/요구사항 반영
     * - 배경: 완전 흰색
     * - 텍스트: 홈 설명/2번 상하/3번/4번/5번 박스 위 텍스트는 CSS로 숨김 처리
     * - 이미지: 임의 리사이징 금지 (width/height auto, max만 제한)
     * - 볼 선택: 순서대로 빠르게 바뀌는 룰렛 -> 탭하면 그 순간의 볼 선택(랜덤 느낌)
     * - 포켓몬: poke_01 ~ poke_30 자동
     ************************/

    // ✅ 포켓몬 01~30 자동 생성
    const pokemonList = [];
    for (let i = 1; i <= 30; i++) {
      pokemonList.push(`images/poke_${String(i).padStart(2, "0")}.png`);
    }

    const CONFIG = {
      balls: [
        "images/Beast_ball.png",
        "images/Fast_ball.png",
        "images/Net_ball.png",
        "images/Great_ball.png",
        "images/Master_ball.png",
        "images/Poke_ball.png",
        "images/Ultra_ball.png",
      ],
      pokemons: pokemonList,

      rouletteIntervalMs: 80,     // 작을수록 더 빠름
      rouletteStartDelayMs: 200,  // 시작 후 룰렛 시작 딜레이
      countdownMs: 900
    };

    const $ = (sel) => document.querySelector(sel);
    const screens = ["#s1", "#s2", "#s3", "#s4", "#s5"].map(s => $(s));

    const toast = $("#toast");
    const startBtn = $("#startBtn");
    const back1 = $("#back1");
    const restart = $("#restart");
    const again = $("#again");
    const home = $("#home");

    const rouletteWrap = $("#rouletteWrap");
    const rouletteImg  = $("#rouletteImg");

    const throwArea = $("#throwArea");
    const throwBall = $("#throwBall");
    const throwBallImg = $("#throwBallImg");
    const capBallImg = $("#capBallImg");
    const countEl = $("#count");

    const flash = $("#flash");
    const pokeImg = $("#pokeImg");

    let chosenBallSrc = "images/Poke_ball.png";
    let chosenPokemonSrc = "";

    // roulette state
    let rouletteTimer = null;
    let rouletteIndex = 0;
    let rouletteArmed = false;
    let rouletteStartTimer = null;

    // swipe/counter state
    let countdownTimer = null;
    let touch = { active:false, startY:0, startX:0, startT:0 };

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add("on");
      setTimeout(()=>toast.classList.remove("on"), 650);
    }

    function go(n){
      screens.forEach((el,i)=> el.classList.toggle("active", i===n));
    }

    function pickRandom(arr){
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function stopRoulette(){
      rouletteArmed = false;
      if (rouletteTimer) clearInterval(rouletteTimer);
      rouletteTimer = null;
      if (rouletteStartTimer) clearTimeout(rouletteStartTimer);
      rouletteStartTimer = null;
    }

    function resetAll(){
      chosenBallSrc = "images/Poke_ball.png";
      chosenPokemonSrc = "";

      stopRoulette();
      rouletteIndex = 0;
      rouletteImg.src = chosenBallSrc;

      throwBallImg.src = chosenBallSrc;
      capBallImg.src = chosenBallSrc;

      flash.classList.remove("on");
      pokeImg.classList.remove("show");
      pokeImg.src = "";
    }

    /*************** Screen2 Roulette ***************/
    function startRoulette(){
      rouletteArmed = true;
      rouletteIndex = 0;

      rouletteTimer = setInterval(() => {
        rouletteIndex = (rouletteIndex + 1) % CONFIG.balls.length;
        rouletteImg.src = CONFIG.balls[rouletteIndex];
      }, CONFIG.rouletteIntervalMs);
    }

    function enterScreen2(){
      go(1);
      resetAll();

      rouletteStartTimer = setTimeout(() => {
        startRoulette();
      }, CONFIG.rouletteStartDelayMs);
    }

    function onRouletteTap(){
      if (!rouletteArmed) return;

      chosenBallSrc = CONFIG.balls[rouletteIndex];
      stopRoulette();

      throwBallImg.src = chosenBallSrc;
      capBallImg.src = chosenBallSrc;

      go(2); // Screen3
    }

    rouletteWrap.addEventListener("click", onRouletteTap);

    /*************** Screen3 Swipe Throw ***************/
    function onTouchStart(e){
      if (e.touches && e.touches.length){
        touch.active = true;
        touch.startY = e.touches[0].clientY;
        touch.startX = e.touches[0].clientX;
        touch.startT = performance.now();
      }
    }
    function onTouchMove(e){
      if (!touch.active) return;
      const y = e.touches[0].clientY;
      const dy = Math.min(0, y - touch.startY);
      throwBall.style.transform = `translateX(-50%) translateY(${dy * 0.35}px)`;
      e.preventDefault();
    }
    function onTouchEnd(e){
      if (!touch.active) return;
      touch.active = false;

      const endT = performance.now();
      const dt = Math.max(1, endT - touch.startT);

      const ct = (e.changedTouches && e.changedTouches[0]) ? e.changedTouches[0] : null;
      const endY = ct ? ct.clientY : touch.startY;
      const dyTotal = endY - touch.startY;

      throwBall.style.transform = `translateX(-50%)`;

      if (dyTotal < -70){
        const speed = Math.min(1.6, Math.max(0.6, (-dyTotal) / dt * 2.2));
        animateThrow(speed);
      }
    }

    function animateThrow(speed){
      throwBall.style.transition = "transform .38s ease";
      const up = -380 * speed;
      const scale = 0.42;
      throwBall.style.transform = `translateX(-50%) translateY(${up}px) scale(${scale}) rotate(${220*speed}deg)`;

      setTimeout(() => {
        throwBall.style.transition = "transform .1s ease";
        throwBall.style.transform = `translateX(-50%)`;
        enterScreen4();
      }, 420);
    }

    /*************** Screen4 Countdown ***************/
    function enterScreen4(){
      go(3);
      countEl.textContent = "3";
      clearInterval(countdownTimer);

      let n = 3;
      countdownTimer = setInterval(() => {
        n--;
        countEl.textContent = String(n);
        if (n <= 0){
          clearInterval(countdownTimer);
          enterScreen5();
        }
      }, CONFIG.countdownMs);
    }

    /*************** Screen5 Reveal ***************/
    function enterScreen5(){
      go(4);
      chosenPokemonSrc = pickRandom(CONFIG.pokemons);

      flash.classList.add("on");
      setTimeout(() => flash.classList.remove("on"), 220);

      pokeImg.src = chosenPokemonSrc;
      setTimeout(() => {
        pokeImg.classList.add("show");
      }, 80);
    }

    /*************** Buttons ***************/
    startBtn.addEventListener("click", () => enterScreen2());
    back1.addEventListener("click", () => { stopRoulette(); go(0); });
    restart.addEventListener("click", () => enterScreen2());
    again.addEventListener("click", () => enterScreen2());
    home.addEventListener("click", () => { stopRoulette(); go(0); });

    /*************** Swipe listeners ***************/
    throwArea.addEventListener("touchstart", onTouchStart, {passive:false});
    throwArea.addEventListener("touchmove", onTouchMove, {passive:false});
    throwArea.addEventListener("touchend", onTouchEnd, {passive:true});

    // desktop test (mouse)
    let mouseDown = false;
    throwArea.addEventListener("mousedown", (e)=>{
      mouseDown = true;
      touch.active = true;
      touch.startY = e.clientY;
      touch.startX = e.clientX;
      touch.startT = performance.now();
    });
    window.addEventListener("mousemove", (e)=>{
      if (!mouseDown || !touch.active) return;
      const dy = Math.min(0, e.clientY - touch.startY);
      throwBall.style.transform = `translateX(-50%) translateY(${dy * 0.35}px)`;
    });
    window.addEventListener("mouseup", (e)=>{
      if (!mouseDown) return;
      mouseDown = false;
      const endT = performance.now();
      const dt = Math.max(1, endT - touch.startT);
      const dyTotal = e.clientY - touch.startY;
      throwBall.style.transform = `translateX(-50%)`;
      if (dyTotal < -70){
        const speed = Math.min(1.6, Math.max(0.6, (-dyTotal) / dt * 2.2));
        animateThrow(speed);
      }
      touch.active = false;
    });

    showToast("READY");
  </script>
</body>
</html>