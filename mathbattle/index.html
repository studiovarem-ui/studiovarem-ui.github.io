<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <title>Math Battle Â· iOS UI</title>
  <style>
    /* =========================
       SCROLL ì™„ì „ ì°¨ë‹¨ (í•µì‹¬)
    ========================= */
    html, body{
      height:100%;
      margin:0;
      overflow:hidden;              /* ìŠ¤í¬ë¡¤ ì œê±° */
      overscroll-behavior:none;     /* ë°”ìš´ìŠ¤ ë°©ì§€(ì§€ì› ë¸Œë¼ìš°ì €) */
      touch-action:none;            /* í„°ì¹˜ ìŠ¤í¬ë¡¤ ì œìŠ¤ì²˜ ì°¨ë‹¨ */
      -webkit-text-size-adjust:100%;
    }
    body{
      position:fixed;               /* iOSì—ì„œ íŠ¹íˆ ê°•ë ¥ */
      width:100%;
      height:100%;
    }

    /* =========================
       iOS-style UI
    ========================= */
    :root{
      --bg1:#0b0f1a;
      --bg2:#0f1630;
      --card:rgba(255,255,255,.06);
      --card2:rgba(255,255,255,.04);
      --line:rgba(255,255,255,.10);
      --text:#f3f5ff;
      --muted:rgba(243,245,255,.72);
      --muted2:rgba(243,245,255,.45);
      --blue:#6aa9ff;
      --blue2:#557CF3;
      --good:#43e28b;
      --bad:#ff5b6a;
    }

    *{ box-sizing:border-box; font-family: system-ui, -apple-system, "Apple SD Gothic Neo", "Noto Sans KR", sans-serif; }
    .app{
      height:100vh;
      width:100vw;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:16px;
      background:
        radial-gradient(1200px 700px at 20% 10%, rgba(85,124,243,.35), transparent 60%),
        radial-gradient(900px 600px at 80% 40%, rgba(75,172,198,.22), transparent 55%),
        linear-gradient(180deg, var(--bg2), var(--bg1));
      color:var(--text);
    }

    .phone{
      width:min(520px, 96vw);
      height:min(920px, 96vh);
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.04));
      border:1px solid var(--line);
      border-radius:20px;
      padding:16px;
      box-shadow: 0 20px 50px rgba(0,0,0,.35);
    }

    .topRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }

    .sideTitle{
      font-weight:800;
      font-size:18px;
      letter-spacing:-.02em;
    }
    .subMsg{
      margin-top:4px;
      color:var(--muted);
      font-weight:700;
      font-size:13px;
      min-height:18px;
    }

    .nameCol{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .nameLine{
      display:flex;
      align-items:center;
      gap:8px;
      font-weight:900;
      font-size:18px;
    }
    .dot{
      width:8px; height:8px; border-radius:50%;
      background:rgba(255,255,255,.35);
    }
    .hpLine{
      display:flex;
      align-items:center;
      gap:8px;
      font-variant-numeric: tabular-nums;
      color:var(--muted);
      font-size:12px;
      font-weight:800;
    }

    .hpPill{
      width:140px;
      height:10px;
      border-radius:999px;
      background:rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.10);
      overflow:hidden;
    }
    .hpFill{
      height:100%;
      width:70%;
      border-radius:999px;
      background:linear-gradient(90deg, var(--good), rgba(67,226,139,.55));
    }
    .hpFill.bad{
      background:linear-gradient(90deg, var(--bad), rgba(255,91,106,.55));
    }

    .battleCard{
      position:relative;
      overflow:hidden;
    }
    .battleGlow{
      position:absolute; inset:-60px;
      background: radial-gradient(400px 220px at 20% 10%, rgba(106,169,255,.18), transparent 60%),
                  radial-gradient(420px 260px at 90% 40%, rgba(85,124,243,.16), transparent 60%);
      pointer-events:none;
      filter: blur(0px);
    }

    .questionCard{
      padding:18px;
    }
    .qRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .question{
      font-size:40px;
      font-weight:1000;
      letter-spacing:-.03em;
    }
    .timerPill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 14px;
      border-radius:999px;
      background:rgba(255,255,255,.07);
      border:1px solid rgba(255,255,255,.10);
      font-weight:900;
      font-variant-numeric: tabular-nums;
      min-width:96px;
      justify-content:center;
    }
    .hint{
      margin-top:10px;
      color:var(--muted);
      font-size:14px;
      font-weight:700;
    }

    .inputRow{
      margin-top:14px;
      display:flex;
      gap:12px;
      align-items:stretch;
    }
    .answer{
      flex:1;
      height:56px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.20);
      color:var(--text);
      font-size:18px;
      padding:0 14px;
      outline:none;
      font-weight:900;
    }
    .answer::placeholder{ color:rgba(243,245,255,.35); font-weight:900; }

    .attackBtn{
      width:72px;
      height:56px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(106,169,255,.95), rgba(85,124,243,.95));
      color:white;
      font-weight:1000;
      font-size:14px;
      cursor:pointer;
      box-shadow: 0 10px 20px rgba(85,124,243,.25);
    }
    .attackBtn:active{ transform: translateY(1px); filter:brightness(.98); }
    .attackBtn[disabled]{ opacity:.45; cursor:not-allowed; }

    .grid2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }

    .miniCard{
      background:rgba(255,255,255,.045);
      border:1px solid rgba(255,255,255,.10);
      border-radius:18px;
      padding:14px;
      min-height:84px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:6px;
    }
    .miniLabel{
      color:var(--muted);
      font-weight:900;
      font-size:12px;
      letter-spacing:-.01em;
    }
    .miniValue{
      font-weight:1000;
      font-size:32px;
      letter-spacing:-.02em;
      font-variant-numeric: tabular-nums;
    }

    .footerRow{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
    }
    .pillRow{
      flex:1;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:center;
      padding:12px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.05);
      color:rgba(243,245,255,.85);
      font-weight:900;
      font-size:13px;
      overflow:hidden;
      white-space:nowrap;
      text-overflow:ellipsis;
    }
    .smallBtn{
      padding:10px 12px;
      border-radius:14px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      color:var(--text);
      font-weight:900;
      cursor:pointer;
    }
    .smallBtn:active{ transform: translateY(1px); }

    .flash{
      position:absolute; inset:0;
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease;
    }
    .flash.good{ background:rgba(67,226,139,.16); }
    .flash.bad{ background:rgba(255,91,106,.16); }

    .shake{ animation:shake .22s linear 1; }
    @keyframes shake{
      0%{transform:translateX(0)}
      25%{transform:translateX(-6px)}
      50%{transform:translateX(6px)}
      75%{transform:translateX(-4px)}
      100%{transform:translateX(0)}
    }

    .controls{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:12px;
    }
    select{
      height:46px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.20);
      color:var(--text);
      font-weight:900;
      padding:0 12px;
      outline:none;
      appearance:none;
    }

    @media (max-width:420px){
      .question{ font-size:34px; }
      .miniValue{ font-size:28px; }
      .timerPill{ min-width:86px; padding:9px 12px; }
    }
  </style>
</head>

<body>
  <div class="app">
    <div class="phone">

      <!-- BATTLE STATUS -->
      <div class="card battleCard">
        <div class="battleGlow"></div>
        <div class="flash good" id="flashGood"></div>
        <div class="flash bad" id="flashBad"></div>

        <div class="topRow">
          <div class="nameCol" style="min-width:46%">
            <div class="nameLine"><span class="dot"></span><span id="heroName">ì£¼ì¸ê³µ</span></div>
            <div class="subMsg" id="heroMsg">ì¤€ë¹„!</div>
            <div class="hpLine">
              <div class="hpPill"><div class="hpFill" id="heroHpBar"></div></div>
              <span id="heroHpTxt">100</span>
            </div>
          </div>

          <div class="nameCol" style="text-align:right; min-width:46%">
            <div class="nameLine" style="justify-content:flex-end;"><span id="mobName">ìŠ¬ë¼ì„</span><span class="dot"></span></div>
            <div class="subMsg" id="mobMsg" style="text-align:right;">ë¤ë²¼!</div>
            <div class="hpLine" style="justify-content:flex-end;">
              <span id="mobHpTxt">60</span>
              <div class="hpPill"><div class="hpFill bad" id="mobHpBar"></div></div>
            </div>
          </div>
        </div>

        <div style="margin-top:12px; display:flex; align-items:center; justify-content:space-between; gap:10px;">
          <div style="color:var(--muted2); font-weight:900; font-size:12px;" id="stageTxt">ìŠ¤í…Œì´ì§€ 1</div>
          <button class="smallBtn" id="resetBtn">ì²˜ìŒë¶€í„°</button>
        </div>
      </div>

      <!-- QUESTION -->
      <div class="card questionCard">
        <div class="qRow">
          <div class="question" id="question">10 - 0 = ?</div>
          <div class="timerPill"><span>â±</span><span id="timer">3.5</span></div>
        </div>
        <div class="hint">ì •ë‹µì„ ì…ë ¥í•˜ê³  <b>ê³µê²©!</b>ì„ ëˆ„ë¥´ì„¸ìš”. (ì—”í„°ë„ ê°€ëŠ¥)</div>

        <div class="inputRow">
          <input id="answer" class="answer" type="number" inputmode="numeric" placeholder="ì •ë‹µ" />
          <button id="attackBtn" class="attackBtn">ê³µê²©!</button>
        </div>

        <div class="controls">
          <select id="difficulty">
            <option value="easy" selected>ë‚œì´ë„ Â· ì‰¬ì›€</option>
            <option value="normal">ë‚œì´ë„ Â· ë³´í†µ</option>
            <option value="hard">ë‚œì´ë„ Â· ì–´ë ¤ì›€</option>
          </select>
          <select id="ops">
            <option value="mix" selected>ì‚¬ì¹™ Â· í˜¼í•©</option>
            <option value="add">ë§ì…ˆ</option>
            <option value="sub">ëº„ì…ˆ</option>
            <option value="mul">ê³±ì…ˆ</option>
            <option value="div">ë‚˜ëˆ—ì…ˆ(ë”± ë–¨ì–´ì§)</option>
          </select>
        </div>
      </div>

      <!-- STATS -->
      <div class="grid2">
        <div class="miniCard">
          <div class="miniLabel">ì ìˆ˜</div>
          <div class="miniValue" id="score">0</div>
        </div>
        <div class="miniCard" style="align-items:flex-end; text-align:right;">
          <div class="miniLabel">ì—°ì† ì •ë‹µ</div>
          <div class="miniValue" id="streak">0</div>
        </div>
      </div>

      <!-- FOOTER -->
      <div class="card">
        <div class="footerRow">
          <div class="miniCard" style="flex:1; margin:0; min-height:auto; padding:12px 14px;">
            <div class="miniLabel">ë‚œì´ë„</div>
            <div class="miniValue" style="font-size:28px;" id="diffTxt">ì‰¬ì›€</div>
          </div>
          <div class="miniCard" style="flex:1; margin:0; min-height:auto; padding:12px 14px; align-items:flex-end; text-align:right;">
            <div class="miniLabel">ë‚¨ì€ ë¬¸ì œ</div>
            <div class="miniValue" style="font-size:28px;" id="remainTxt">5</div>
          </div>
        </div>

        <div style="margin-top:12px;" class="pillRow" id="domainPill">studiovarem-ui.github.io</div>
      </div>

    </div>
  </div>

  <script>
    /* =========================
       iOSì—ì„œ 'ì¡ì•„ë‹¹ê¹€ ìŠ¤í¬ë¡¤'ê¹Œì§€ ì°¨ë‹¨
    ========================= */
    document.addEventListener('touchmove', (e) => e.preventDefault(), { passive:false });

    (() => {
      // ----- ìƒíƒœ -----
      const state = {
        stage: 1,
        heroMax: 100,
        heroHp: 100,
        mobMax: 60,
        mobHp: 60,
        score: 0,
        streak: 0,
        remain: 5,
        difficulty: 'easy',
        ops: 'mix',
        timer: 3.5,
        ticking: null,
        current: null
      };

      const mobs = [
        { name:'ìŠ¬ë¼ì„', hp:60 },
        { name:'ê³ ë¸”ë¦°', hp:72 },
        { name:'ë“œë˜ê³¤', hp:85 },
        { name:'ë³´ìŠ¤',   hp:100 }
      ];

      // ----- ì—˜ë¦¬ë¨¼íŠ¸ -----
      const $ = (id) => document.getElementById(id);
      const heroHpBar = $('heroHpBar');
      const mobHpBar  = $('mobHpBar');
      const heroHpTxt = $('heroHpTxt');
      const mobHpTxt  = $('mobHpTxt');
      const heroMsg   = $('heroMsg');
      const mobMsg    = $('mobMsg');
      const heroName  = $('heroName');
      const mobName   = $('mobName');
      const stageTxt  = $('stageTxt');

      const question  = $('question');
      const timerEl   = $('timer');
      const answer    = $('answer');
      const attackBtn = $('attackBtn');
      const resetBtn  = $('resetBtn');

      const scoreEl   = $('score');
      const streakEl  = $('streak');
      const remainEl  = $('remainTxt');
      const diffTxt   = $('diffTxt');

      const difficultySel = $('difficulty');
      const opsSel        = $('ops');

      const flashGood = $('flashGood');
      const flashBad  = $('flashBad');

      // ----- ìœ í‹¸ -----
      const clamp = (v,a,b)=>Math.max(a,Math.min(b,v));
      const rint = (a,b)=>Math.floor(Math.random()*(b-a+1))+a;

      function diffConfig(){
        if(state.difficulty==='easy')   return {max:10, mulMax:5, time:3.5};
        if(state.difficulty==='normal') return {max:20, mulMax:9, time:3.2};
        return {max:50, mulMax:12, time:3.0};
      }

      function setBars(){
        heroHpTxt.textContent = state.heroHp;
        mobHpTxt.textContent  = state.mobHp;
        heroHpBar.style.width = (state.heroHp/state.heroMax*100)+'%';
        mobHpBar.style.width  = (state.mobHp/state.mobMax*100)+'%';
      }

      function flash(kind){
        const el = (kind==='good') ? flashGood : flashBad;
        el.style.opacity = '1';
        setTimeout(()=> el.style.opacity='0', 160);
      }

      function stopTimer(){
        if(state.ticking) clearInterval(state.ticking);
        state.ticking = null;
      }
      function startTimer(){
        stopTimer();
        state.timer = diffConfig().time;
        timerEl.textContent = state.timer.toFixed(1);

        state.ticking = setInterval(()=>{
          state.timer = Math.max(0, state.timer - 0.1);
          timerEl.textContent = state.timer.toFixed(1);
          if(state.timer <= 0){
            stopTimer();
            onWrong('ì‹œê°„ ì´ˆê³¼!');
          }
        }, 100);
      }

      function generateQuestion(){
        const cfg = diffConfig();
        let mode = state.ops;
        if(mode==='mix'){
          const ops = ['add','sub','mul','div'];
          mode = ops[rint(0,ops.length-1)];
        }

        let a,b,q,ans;
        if(mode==='add'){
          a=rint(0,cfg.max); b=rint(0,cfg.max);
          q=`${a} + ${b} = ?`; ans=a+b;
        }else if(mode==='sub'){
          a=rint(0,cfg.max); b=rint(0,cfg.max);
          if(b>a) [a,b]=[b,a];
          q=`${a} - ${b} = ?`; ans=a-b;
        }else if(mode==='mul'){
          a=rint(0,cfg.mulMax); b=rint(0,cfg.mulMax);
          q=`${a} Ã— ${b} = ?`; ans=a*b;
        }else{ // div (ë”± ë–¨ì–´ì§)
          b=rint(1,cfg.mulMax);
          ans=rint(0,cfg.mulMax);
          a=b*ans;
          q=`${a} Ã· ${b} = ?`;
        }
        return {q, a: ans};
      }

      function updateStats(){
        scoreEl.textContent = state.score;
        streakEl.textContent = state.streak;
        remainEl.textContent = state.remain;
        stageTxt.textContent = `ìŠ¤í…Œì´ì§€ ${state.stage}`;
        diffTxt.textContent =
          state.difficulty==='easy' ? 'ì‰¬ì›€' :
          state.difficulty==='normal' ? 'ë³´í†µ' : 'ì–´ë ¤ì›€';
      }

      function nextQuestion(){
        state.current = generateQuestion();
        question.textContent = state.current.q;
        answer.value = '';
        answer.focus();
        startTimer();
      }

      function nextStage(){
        stopTimer();
        state.stage += 1;

        const m = mobs[Math.min(mobs.length-1, state.stage-1)];
        const extra = (state.stage-1)*8;
        state.mobMax = m.hp + extra;
        state.mobHp  = state.mobMax;
        mobName.textContent = m.name;

        // ì´ˆë“± ì €í•™ë…„ìš©: ë‹¤ìŒ ìŠ¤í…Œì´ì§€ë¡œ ê°ˆ ë•Œ ì•½ê°„ íšŒë³µ
        state.heroHp = clamp(state.heroHp + 15, 0, state.heroMax);

        state.remain = 5;
        state.streak = 0;

        heroMsg.textContent = 'ë‹¤ìŒ!';
        mobMsg.textContent = 'ë¤ë²¼!';
        setBars();
        updateStats();

        // 6ìŠ¤í…Œì´ì§€ì—ì„œ ì—”ë”©(ì›í•˜ë©´ ë°”ê¿”ë„ ë¨)
        if(state.stage >= 6){
          attackBtn.disabled = true;
          answer.disabled = true;
          question.textContent = 'ğŸ‰ ì¶•í•˜í•´ìš”! ëª¨ë‘ ë¬¼ë¦¬ì³¤ì–´ìš”!';
          timerEl.textContent = '--.-';
          return;
        }

        nextQuestion();
      }

      function onCorrect(){
        flash('good');
        heroMsg.textContent = 'ê³µê²© ì„±ê³µ!';
        mobMsg.textContent  = 'ì•„ì•¼!';

        const baseDmg = 12;
        const bonus = Math.min(10, state.streak*2);
        const dmg = baseDmg + bonus;

        state.mobHp = clamp(state.mobHp - dmg, 0, state.mobMax);
        state.score += 10 + bonus;
        state.streak += 1;
        state.remain -= 1;

        setBars();
        updateStats();

        if(state.mobHp <= 0){
          nextStage();
          return;
        }
        if(state.remain <= 0){
          // ë‚¨ì€ ë¬¸ì œê°€ ëë‚˜ë©´ ìŠ¤í…Œì´ì§€ í†µê³¼(ì¹œí™”ì )
          nextStage();
          return;
        }
        nextQuestion();
      }

      function onWrong(reason='ì˜¤ë‹µ!'){
        flash('bad');
        heroMsg.textContent = 'í”¼ê²©â€¦';
        mobMsg.textContent  = 'í—¤í—·!';

        const dmg = 10;
        state.heroHp = clamp(state.heroHp - dmg, 0, state.heroMax);
        state.streak = 0;
        state.remain -= 1;

        setBars();
        updateStats();

        if(state.heroHp <= 0){
          stopTimer();
          attackBtn.disabled = true;
          answer.disabled = true;
          question.textContent = 'ğŸ’¥ ê²Œì„ ì˜¤ë²„! ë‹¤ì‹œ í•´ë³¼ê¹Œìš”?';
          timerEl.textContent = '--.-';
          return;
        }
        if(state.remain <= 0){
          nextStage();
          return;
        }
        nextQuestion();
      }

      function submit(){
        if(!state.current) return;
        const v = answer.value.trim();
        if(v === ''){
          stopTimer();
          onWrong('ì…ë ¥ ì•ˆ í•¨!');
          return;
        }
        stopTimer();
        const num = Number(v);
        if(Number.isNaN(num)){
          onWrong('ìˆ«ìê°€ ì•„ë‹˜!');
          return;
        }
        if(num === state.current.a) onCorrect();
        else onWrong('ì˜¤ë‹µ!');
      }

      function resetAll(){
        stopTimer();
        state.stage = 1;
        state.heroHp = 100;
        state.heroMax = 100;
        state.score = 0;
        state.streak = 0;
        state.remain = 5;

        state.difficulty = difficultySel.value;
        state.ops = opsSel.value;

        const m = mobs[0];
        state.mobMax = m.hp;
        state.mobHp  = state.mobMax;
        mobName.textContent = m.name;

        heroName.textContent = 'ì£¼ì¸ê³µ';
        heroMsg.textContent = 'ì¤€ë¹„!';
        mobMsg.textContent = 'ë¤ë²¼!';

        attackBtn.disabled = false;
        answer.disabled = false;

        setBars();
        updateStats();
        nextQuestion();
      }

      // ----- ì´ë²¤íŠ¸ -----
      attackBtn.addEventListener('click', submit);
      answer.addEventListener('keydown', (e)=>{ if(e.key==='Enter') submit(); });

      resetBtn.addEventListener('click', resetAll);
      difficultySel.addEventListener('change', resetAll);
      opsSel.addEventListener('change', resetAll);

      // ì‹œì‘
      resetAll();
    })();
  </script>
</body>
</html>